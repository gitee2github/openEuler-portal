---
title: openEuler NFS+协议全新发布：实现NAS存储性能与可靠性倍增
category: blog
date: 2023-04-24
tags:
  - NFS+
  - NAS存储
archives: 2023-04
author:
  - openEuler
summary: openEuler发布NFS+协议，实现单客户端访问NAS存储可靠性提升3倍、性能提升6倍，助力NAS存储全面满足新型生产核心场景下苛刻要求。
---


4月21日，在openEuler Developer Day
2023上，openEuler发布NFS+协议，实现单客户端访问NAS存储可靠性提升3倍、性能提升6倍，助力NAS存储全面满足新型生产核心场景下苛刻要求。

<img src="./media/image1.jpeg" width="500" >

# 传统NFS面临挑战

网络文件系统（NFS）是一种分布式文件系统协议，最初由Sun公司于1984年开发，它允许客户端上的用户通过网络访问服务端文件系统中的数据。由于其配置简单，使用方便，已广泛应用于金融数据交换平台，EDA仿真，话单，票据影像等行业。随着应用场景扩张，数据重要性不断提高，各行业对NAS存储的可靠性和性能提出了更高的诉求。传统NFS单个挂载点仅指定一个服务端IP地址，在使用过程中面临以下挑战：

首先，在网口故障或者链路故障场景下，挂载点无法访问，导致业务IO挂死，可靠性不足；

其次，NAS存储部署于公共区，主机访问需要跨三层组网，一端故障时IP无法感知，当前依靠应用层手动挂载文件系统，双活链路无法自动切换。

再次，单个挂载点性能受限于单个物理链路性能，重要业务存在性能瓶颈。

# 基于openEuler操作系统的NFS多路径技术原理

生产NAS存储使用NFS协议，要求Client及Server端到端提供故障解决方案，以及超越本地文件系统的高性能数据共享能力。例如，在Client侧，要求链路高可靠、并发高性能；在Server侧，要求具备权限/资源管控/灾备/安全等能力。

面对以上关键挑战，openEuler推出全新NFS+协议。NFS+协议是运行在openEuler操作系统内核中的驱动模块，包含NFS协议层的挂载参数管理模块和传输层多路径管理模块。NFS+通过指定多个本地IP地址和多个服务端IP地址，实现不同IP地址建立多条TCP/RDMA链路，实现多路径建链、故障恢复和倒换、负载均衡等特性。

<img src="./media/image2.jpeg" width="500" >

**NFS+协议全面提升NAS性能与可靠性**

NFS+协议未修改操作系统数据面，对主机CPU资源无占用，仅在控制面新增多路径功能，实现跨控、跨设备、跨站点故障秒级自动切换，NAS存储访问性能提升6倍，可靠性提升3倍。

## 故障切换和恢复

NFS+协议自动感知链路故障异常，对故障链路进行降级隔离，通过业界首创三层网络双活路径自动切换，实现下层存储故障或主机侧IO超时，跨站点AA双活主动切换，解决跨引擎失效、主机无感知问题。

-   故障切换：NFS+协议发现链路故障时会自动将IO切换到其他可用链路上，实现链路故障IO无感知。

-   故障恢复：NFS+协议可自动检测链路状态，在链路故障恢复后自动将I/O重新下发到该路径。

## 链路负载均衡

NFS+通过网卡端口/多网卡/多节点聚合，提升主机并发访问能力。NFS+协议为NFSv3协议提供基本的Round
Robin选路算法，实现单个挂载点在多条链路上均衡下发IO，充分利用多条物理链路能力，实现单个挂载点NFS性能提升。

<img src="./media/image3.jpeg" width="500" >

## 最优路径算法自定义

NFS+协议提供厂商自定义选路算法接口，存储服务端厂商可基于自身特点自定义最优选路算法，实现性能最优。

 

面对新场景、新业务、新需求，企业需要及时响应快速变化的用户需求，才能在激烈的竞争中保持领先。openEuler将联合社区伙伴与开发者持续共建NAS生态，打造性能、可靠性倍增的NFS+协议，助力NAS存储性能及可靠性全面提升，提供高可靠、高性能、易运维的NAS存储解决方案，加速数字化转型。
